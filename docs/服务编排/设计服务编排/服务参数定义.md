## 功能简介

当前服务的所有全局数据都会存储于 `state `下。通常服务的参数主要分成以下几类：

- 服务入参

- 服务出参

- 节点出参

- 其他参数

## 参数类型

服务编排支持以下类型变量

<table>
  <thead>
    <tr>
      <th>分类</th><th>参数类型</th><th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td colSpan="2">基础变量</td>
      <td>字符串、数字、布尔</td>
    </tr>
		<tr>
      <td rowSpan="2">对象类</td>
      <td>实体对象</td>
      <td>基于实体表结构定义的对象，其成员和实体表字段一致。</td>
    </tr>
		<tr>
      <td>自定义对象</td>
      <td>通过自定义对象成员，从而形成的自定义对象。</td>
    </tr>
 		<tr>
      <td rowSpan="3">数组类</td>
      <td>基础变量数组</td>
      <td>基于基础变量，从而形成的数组。</td>
    </tr>
		<tr>
      <td>实体对象数组</td>
      <td>基于实体表结构定义，从而形成的实体对象数组。</td>
    </tr>
		<tr>
      <td>自定义对象数组</td>
      <td>基于自定义对象，从而形成的数组。</td>
    </tr>
  </tbody>
</table>



## 服务入参

服务入参即是当前服务编排的请求参数，即通过可视化、结构化定义整个服务的入参，以便于支持以下场景：

- 被前端、流程、其他服务等调用时，能够可视化配置；
- 使得当前编排的服务，能被前端、流程、其他服务等更方便地重复调用。

### 入参的定义

**定义规则：**

- 服务的入参支持基于参数类型进行定义服务的入参；

- 定义的参数都会存储与服务的全局数据下，即 state.input

**操作路径：** 开始节点/ 服务入参

![image-20220925171131824](/img/服务编排/服务编排设计/服务参数定义/parameter01.png)

### 入参的使用

入参的使用可以分成几种方式

**直接引用的方式**

由于入参是存储与 State.input 下，我们可以通过 input.{入参名字}，对入参进行引用，如下图所示：

![image-20220925172217355](/img/服务编排/服务编排设计/服务参数定义/parameter02.png)

**通过表达式选择**

![image-20220925172623923](/img/服务编排/服务编排设计/服务参数定义/parameter03.png)

## 服务出参

定义服务的出参，即返回的数据。

### 出参的定义

**操作路径：**结束节点/服务出参

![image-20220925173143954](/img/服务编排/服务编排设计/服务参数定义/parameter04.png)

**相关背景**：由于爱速搭前端要求的返回的数据结构如下所示：

```json
{
  "status": 0,
  "msg": "",
  "data": {
    ...其他字段
  }
}
```

- **status**: 返回 `0`，表示当前接口正确返回，否则按错误请求处理；
- **msg**: 返回接口处理信息，主要用于表单提交或请求失败时的 `toast` 显示；
- **data**: 必须返回一个具有 `key-value` 结构的对象。

**`status`、`msg`和 **`data`字段为接口返回的必要字段。

爱速搭的服务出参的定义仅仅是对 **`data`** 结构的定义，其中**`status`、`msg`** 会自动作为返回参数。

**定义规则**：爱速搭的 data 定义支持以下两种方式

- 出参赋值：即对整个 **`data`**进行赋值
- 出参成员赋值：即对 **`data`**的成员进行单独赋值

### msg、status 的定义

当我们需要对**`msg`**、**`status`**进行定义时，可以通过设置变量活动，进行**`msg`**、**`status`**值的定义

![image-20220925175215241](/img/服务编排/服务编排设计/服务参数定义/parameter05.png)

## 节点出参

节点出参主要是考虑到进行编排中各个节点进行协作 ，即各节点执行后输出的参数，能够命名节点出参，以便于被后续的其他节点使用，因此部分节点会有对应的节点出参。

### 节点出参的定义

**操作路径：**如下图所示，选择节点→ 设置节点出参

![image-20220925175507424](/img/服务编排/服务编排设计/服务参数定义/paramter06.png)

**定义规则**

节点出参以下两种场景：

- 自定义节点出参：即新定义的节点出参可以在后续节点中使用；
- 覆盖已有参数：当变量名重复时，如从上下文变量中选择已有参数时，则是进行参数的覆盖。
