---
id: 企微集成
---

平台可以通过集成企微实现组织架构同步、企微应用集成与免登、流程消息打通企微通知等功能。

### 组织同步

组织同步功能能将企微的组织部门架构及成员信息同步到平台，简单几步即可完成配置：

#### 1、 进入平台管理-系统集成-企业微信，查看组织同步需要填写的基本信息

![image.png](/img/组织管理/企微集成/data-01.jpg)

需要填写的信息主要包括：应用基础信息、应用地址、事件订阅、同步配置等。其中企微 Corp ID 在企微管理后台企业信息底部：

![image.png](/img/组织管理/企微集成/data-03.jpg)

#### 2、 创建企微对接应用

企微管理员需要进入企微管理后台[开发者后台](https://work.weixin.qq.com/wework_admin/frame#apps), 创建企业内部应用

![image.png](/img/组织管理/企微集成/data-02.jpg)

应用创建好后即可在应用信息里查看 AgentId 和 Secret，将这些信息填写到平台，同时将平台提供的应用主页设置到企微应用主页里。

![image.png](/img/组织管理/企微集成/data-04.jpg)

注意此应用负责组织架构同步和平台级接入，应用要具备读取部门组织通讯录的权限。

#### 3、设置应用的可信域名和可信 IP

企业微信内实现免登的回调域名必须是备案的可信域名，因此平台需要绑定备案过的域名(支持带端口)。平台绑定域名后在企微应用设置里点击申请域名校验，域名校验通过将允许使用。

![image.png](/img/组织管理/企微集成/data-05.jpg)

同样在企微应用里设置可信 IP，将平台的服务器公网出口 IP 填写到应用里(最多支持 120 个)。只有名单内的 IP 发起的请求才能请求企微提供的服务端接口。

![image.png](/img/组织管理/企微集成/data-06.jpg)

#### 4、通讯录同步

配置消息订阅支持在企微组织成员数据变更时，通过接口机制自动同步到平台。进入企微后台-通讯录同步，点击开启同步并获取平台内的事件通知地址填写到 URL 里，另外将企微生成的 Token 和 EncodingAESKey 填写到平台的 token 和加密密钥处。

![image.png](/img/组织管理/企微集成/data-07.jpg)

![image.png](/img/组织管理/企微集成/data-08.jpg)

#### 5、同步组织架构

在平台管理中心-组织架构处点击组织同步，选择企业微信，点击确认同步即可触发异步同步任务，稍后平台将自动完成组织架构的同步。完成组织同步后即可在平台对不同成员设置角色及权限，成员可以通过企微直接打开对应的应用。注意组织同步对应的应用在企微打开将默认进入平台工作台，如果想在企微内直接通过应用列表打开单个应用，则需要新增企微应用级接入。

注意组织内的用户必须使用具备唯一标识能力的字段进行同步，默认是手机号，需要每个成员都填写手机号)，此外可在平台自定义同步规则里设置邮箱、用户 ID 等作为唯一标识。

### 企微应用接入

企微单个应用接入无需处理组织同步信息，接入步骤比组织级别应用简单。只需要创建应用填写应用的首页地址并配置可信域名及可信 IP 即可。应用的首页地址在平台应用-应用设置-系统集成里可以看到

![image.png](/img/组织管理/企微集成/data-09.jpg)

### 企微消息通知

在流程属性里，打开企微通知即可完成流程与企微通知的对接。流程流转时，将通过企微自动发送信息给对应的审批人，审批人可以在企微内点击链接直接登录应用进行审批操作。

![image.png](/img/组织管理/企微集成/data-10.jpg)
